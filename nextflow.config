resume = true

profiles {
    magnus {
        workDir = '/group/ja3/WALLABY/runs/work/'
        tmpDir = '/group/ja3/WALLABY/tmp/'

        process {
            cache = 'lenient'
            stageInMode = 'symlink'
        }

        process {
            executor = 'slurm'
            queue = 'workq'
            module = 'singularity'
            clusterOptions = '--nodes=1 --account=ja3 --time=24:00:00'

            withName: linmos {
                module = 'singularity'
                executor = 'slurm'
                clusterOptions = '--account=ja3 --nodes=12 --ntasks-per-node=24 --cpus-per-task=1 --time=24:00:00'
                queue = 'workq'
            }
        }

        params {
            SCRATCH_ROOT = "/group/ja3/WALLABY/"
            ASTROPY_CACHEDIR = "/group/ja3/ashen/"

            DOWNLOAD_QUERY = 'SELECT * FROM ivoa.obscore WHERE obs_id IN ($SBIDS) AND (filename LIKE "weights.i.%.cube.fits" OR filename LIKE "image.restored.i.%.cube.contsub.fits")'
            SOFIAX_CONFIG_FILE = "config.ini"
            LINMOS_CONFIG_FILENAME = "linmos.config"

            WALLABY_COMPONENTS_IMAGE = "aussrc/wallaby_scripts:latest"
            CASDA_DOWNLOAD_COMPONENTS_IMAGE = "aussrc/casda_download_components:v0.0.3"
            SOURCE_FINDING_COMPONENTS_IMAGE = "aussrc/source_finding_components:latest"
            LINMOS_IMAGE = "docker://csirocass/yandasoft:1.4.0-mpich"
            S2P_IMAGE = "aussrc/s2p_setup:v0.1.6"
            SOFIA_IMAGE = "docker://astroaustin/sofia:v0.0.1c"
            SINGULARITY_CACHEDIR = "/group/ja3/WALLABY/apps/singularity"
        }

        singularity {
            enabled = true
            cacheDir = '/group/ja3/WALLABY/apps/singularity'
            envWhitelist = 'SINGULARITY_BINDPATH, SINGULARITYENV_LD_LIBRARY_PATH'
        }

        docker.enabled = false
    }

    carnaby {
        docker.enabled = false
    }
}